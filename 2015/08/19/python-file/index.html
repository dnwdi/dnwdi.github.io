<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Python之file | dnwdi</title>
  <meta name="author" content="dnwdi">
  
  <meta name="description" content="dnwdi&#39;s blog | java">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="Python之file"/>
  <meta property="og:site_name" content="dnwdi"/>

  
    <meta property="og:image" content="undefined"/>
  

  
  
    <link href="/favicon.png" rel="icon">
  
  
  <link rel="stylesheet" href="/css/bootstrap.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/google-fonts.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

  <script src="/js/jquery-2.0.3.min.js"></script>

  <!-- analytics -->
  


<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?0986145b5268afabc4775f6b43e924ab";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>


  
  <script src="/snow/js/snow.js"></script>
  <script>createSnow('', 6);</script>
  
  <script src="/water/js/jquery.ripples.js"></script>
</head>

 <body>
  <nav id="main-nav" class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
      <button type="button" class="navbar-header navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
		<span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
	  <a class="navbar-brand" href="/">dnwdi</a>
      <div class="collapse navbar-collapse nav-menu">
		<ul class="nav navbar-nav">
		  
		  <li>
			<a href="/archives" title="All the articles.">
			  <i class="fa fa-archive"></i>Archives
			</a>
		  </li>
		  
		  <li>
			<a href="/categories" title="All the categories.">
			  <i class="fa fa-folder"></i>Categories
			</a>
		  </li>
		  
		  <li>
			<a href="/tags" title="All the tags.">
			  <i class="fa fa-tags"></i>Tags
			</a>
		  </li>
		  
		  <li>
			<a href="/about" title="About me.">
			  <i class="fa fa-user"></i>About
			</a>
		  </li>
		  
		</ul>
      </div>
    </div> <!-- container -->
</nav>
<div class="clearfix"></div>

  <div class="container">
  	<div class="content">
    	 


	
		<div class="page-header">		
			<h1> Python之file</h1>
		</div>		
	



<div class="row post">
	<!-- cols -->
	
	<div class="col-md-9">
	

			

	<!-- content -->
	<div class="mypage">		
	    <p>一. python打开文件代码如下：</p>
<p>f = open(“d:\test.txt”, “w”)<br>说明：<br>第一个参数是文件名称，包括路径；<br>第二个参数是打开的模式mode</p>
<p>‘r’：只读（缺省。如果文件不存在，则抛出错误）<br>‘w’：只写（如果文件不存在，则自动创建文件）<br>‘a’：附加到文件末尾<br>‘r+’：读写<br>如果需要以二进制方式打开文件，需要在mode后面加上字符”b”，比如”rb””wb”等</p>
<p>二、python读取文件内容f.read(size)</p>
<p>参数size表示读取的数量，可以省略。如果省略size参数，则表示读取文件所有内容。</p>
<p>f.readline()读取文件一行的内容 f.readlines()读取所有的行到数组里面[line1,line2,…lineN]。</p>
<p>在避免将所有文件内容加载到内存中，这种方法常常使用，便于提高效率。</p>
<p>三、python写入文件f.write(string)</p>
<p>将一个字符串写入文件，如果写入结束，必须在字符串后面加上”\n”，然后f.close()关闭文件</p>
<a id="more"></a>
<p>四、文件中的内容定位</p>
<p>f.read()读取之后，文件指针到达文件的末尾，如果再来一次f.read()将会发现读取的是空内容，如果想再次读取全部内容，必须将定位指针移动到文件开始：</p>
<p>f.seek(0)<br>这个函数的格式如下（单位是bytes）：f.seek(offset, from_what) from_what表示开始读取的位置，offset表示从from_what再移动一定量的距离，比如f.seek(10, 3)表示定位到第三个字符并再后移10个字符。</p>
<p>from_what值为0时表示文件的开始，它也可以省略，缺省是0即文件开头。下面给出一个完整的例子：</p>
<p>f = open(‘/tmp/workfile’, ‘r+’)<br>f.write(‘0123456789abcdef’)<br>f.seek(5)     # Go to the 6th byte in the file<br>f.read(1)<br>f.seek (-3, 2) # Go to the 3rd byte before the end<br>f.read(1)<br>五、关闭文件释放资源文件操作完毕，一定要记得关闭文件f.close()，可以释放资源供其他程序使</p>
<p>只是ASCII或者gbk编码格式的的文件读写，比较简单，读写如下：</p>
<p>#coding=gbk</p>
<p>f = open(‘c:/intimate.txt’,’r’) # r 指示文件打开模式，即只读<br>s1 = f.read()<br>s2 = f.readline()<br>s3 = f.readlines() #读出所有内容</p>
<p>f.close()</p>
<p>f = open(‘c:/intimate.txt’,’w’) # w 写文件<br>11 f.write(s1)<br>12 f.writelines(s2) # 没有writeline<br>13 f.close()<br>六. f.writelines不会输出换行符。</p>
<p>python unicode文件读写：</p>
<p>#coding=gbk<br>import codecs</p>
<p>f = codecs.open(‘c:/intimate.txt’,’a’,’utf-8’)<br>f.write(u’中文’)<br>s = ‘中文’<br>f.write(s.decode(‘gbk’))<br>f.close()</p>
<p>f = codecs.open(‘c:/intimate.txt’,’r’,’utf-8’)<br>s = f.readlines()<br>f.close()<br>for line in s:<br>    print line.encode(‘gbk’)<br>python代码文件的编码</p>
<p>py文件默认是ASCII编码，中文在显示时会做一个ASCII到系统默认编码的转换，这时就会出错：SyntaxError: Non-ASCII character。需要在代码文件的第一行或第二行添加编码指示：</p>
<p>#coding=utf-8 ##以utf-8编码储存中文字符<br>print ‘中文’像上面那样直接输入的字符串是按照代码文件的编码来处理的，如果用unicode编码，有以下2种方式：<br>s1 = u’中文’ #u表示用unicode编码方式储存信息<br>s2 = unicode(‘中文’,’gbk’)<br>unicode是一个内置函数，第二个参数指示源字符串的编码格式。</p>
<p>decode是任何字符串具有的方法，将字符串转换成unicode格式，参数指示源字符串的编码格式。</p>
<p>encode也是任何字符串具有的方法，将字符串转换成参数指定的格式。</p>
<p>python字符串的编码</p>
<p>用 u’汉字’ 构造出来的是unicode类型，不用的话构造出来是str类型</p>
<p>str的编码是与系统环境相关的，一般就是sys.getfilesystemencoding()得到的值</p>
<p>所以从unicode转str，要用encode方法</p>
<p>从str转unicode，所以要用decode</p>
<p>例如：</p>
<p> #coding=utf-8   #默认编码格式为utf-8</p>
<p>s = u’中文’ #unicode编码的文字<br>print s.encode(‘utf-8’)   #转换成utf-8格式输出<br>print s #效果与上面相同，似乎默认直接转换为指定编码<br>我的总结：</p>
<p>u=u’unicode编码文字’<br>g=u.encode(‘gbk’) #转换为gbk格式<br>print g #此时为乱码，因为当前环境为utf-8,gbk编码文字为乱码<br>str=g.decode(‘gbk’).encode(‘utf-8’)   #以gbk编码格式读取g（因为他就是gbk编码的）并转换为utf-8格式输出<br>print str #正常显示中文<br>安全的方法：</p>
<p>s.decode(‘gbk’,’ignore’).encode(‘utf-8′) #以gbk编码读取（当然是读取gbk编码格式的文字了）并忽略错误的编码，转换成utf-8编码输出<br>因为decode的函数原型是decode([encoding], [errors=’strict’])，可以用第二个参数控制错误处理的策略，默认的参数就是strict，代表遇到非法字符时抛出异常；</p>
<p>如果设置为ignore，则会忽略非法字符；<br>如果设置为replace，则会用?取代非法字符；<br>如果设置为xmlcharrefreplace，则使用XML的字符引用。</p>
	  
	</div>

	<div>
  	<center>
	<div class="pagination">
<ul class="pagination">
	 
				
    	<li class="prev"><a href="/2015/08/19/python-yield/" class="alignleft prev"><i class="fa fa-arrow-circle-o-left"></i>上一页</a></li>
  		

        <li><a href="/archives"><i class="fa fa-archive"></i>Archive</a></li>

		
		   <li class="next"><a href="/2015/08/19/life-lesson1/" class="alignright next">下一页<i class="fa fa-arrow-circle-o-right"></i></a></li>         
        
	
</ul>
</div>

    </center>
	</div>
	
	<!-- comment -->
	
<section id="comment">
  <h2 class="title">留言</h2>

  
  	 <div class="ds-thread" data-thread-key="2015/08/19/python-file/" data-title="Python之file" data-url="http://www.dnwdi.com/2015/08/19/python-file/"></div>  
  
</section>

	
	</div> <!-- col-md-9/col-md-12 -->
	
	
		<div class="col-md-3"> 

	<!-- date -->
	
	<div class="meta-widget">
	<i class="fa fa-clock-o"></i>
	2015-08-19 
	</div>
	

	<!-- categories -->
    
	<div class="meta-widget">
	<a data-toggle="collapse" data-target="#categorys"><i class="fa fa-folder"></i></a>	
    <ul id="categorys" class="tag_box list-unstyled collapse in">
          
  <li>
    <li><a href="/categories/python/">python<span>3</span></a></li>
  </li>

    </ul>
	</div>
	

	<!-- tags -->
	
	<div class="meta-widget">
	<a data-toggle="collapse" data-target="#tags"><i class="fa fa-tags"></i></a>		  
    <ul id="tags" class="tag_box list-unstyled collapse in">	  
	    
  <li><a href="/tags/file/">file<span>1</span></a></li> <li><a href="/tags/python/">python<span>3</span></a></li>
    </ul>
	</div>
		

	<!-- toc -->
	<div class="meta-widget">
	
	</div>
	
    <hr>
	
</div><!-- col-md-3 -->

	

</div><!-- row -->

	</div>
  </div>
  <div class="container-narrow">
  <footer> <p>
  &copy; 2015 dnwdi
  
      Go For IT!    
</p> </footer>
</div> <!-- container-narrow -->
  
<a id="gotop" href="#">   
  <span>▲</span> 
</a>

<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>


<script type="text/javascript">
  var duoshuoQuery = { short_name: 'dnwdi' };
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';
    ds.async = true;
    ds.src = 'http://static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
</script>


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>


</body>
   </html>
